<!DOCTYPE html>
<html lang="<%= I18n.locale %>" class="scroll-smooth" data-controller="admin">
  <head>
    <title>ðŸŽ¬ <%= content_for(:title) || "CinÃ©Room Admin Dashboard" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <!-- Icons -->
    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="apple-touch-icon" href="/icon.png">

    <!-- Fonts (consistent with application) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- CSS Stack: Application -> Active Admin -> Admin Dashboard -->
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "active_admin", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "admin_dashboard", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <style>
      /* Override ActiveAdmin defaults to use our design system */
      body.active_admin {
        background: var(--color-surface) !important;
        color: var(--color-content) !important;
        font-family: var(--font-primary) !important;
        margin: 0 !important;
        padding: 0 !important;
        min-height: 100vh;
      }

      /* Hide default ActiveAdmin header and footer */
      #header, #footer {
        display: none !important;
      }

      /* Custom admin hero using existing variables */
      .admin-hero-section {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(139, 92, 246, 0.1));
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding: 3rem 2rem;
        margin: 0;
      }

      .admin-hero-content {
        max-width: var(--container-max);
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 2rem;
      }

      .admin-hero-title {
        font-size: 3rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
        margin-top: 0;
        font-family: var(--font-display);
      }

      .admin-hero-subtitle {
        color: var(--color-muted);
        font-size: 1.25rem;
        margin-bottom: 1rem;
      }

      .admin-hero-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--color-muted);
        font-size: 0.875rem;
      }

      .status-dot {
        width: 0.5rem;
        height: 0.5rem;
        background: var(--color-accent);
        border-radius: 50%;
        animation: pulse 2s infinite;
      }

      /* Quick nav using existing button styles */
      .admin-quick-nav {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
      }

      .admin-nav-btn {
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        text-decoration: none;
        font-weight: 600;
        transition: var(--transition-normal);
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-family: var(--font-primary);
      }

      .admin-nav-btn.primary {
        background: linear-gradient(135deg, var(--color-primary), #d97706);
        color: white;
      }

      .admin-nav-btn.primary:hover {
        background: linear-gradient(135deg, #d97706, var(--color-primary));
        transform: translateY(-1px);
        box-shadow: 0 8px 25px rgba(245, 158, 11, 0.3);
      }

      .admin-nav-btn.secondary {
        background: rgba(255, 255, 255, 0.05);
        color: var(--color-content);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .admin-nav-btn.secondary:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: rgba(245, 158, 11, 0.3);
      }

      /* Content area styling */
      #active_admin_content {
        background: transparent !important;
        margin: 0 !important;
        padding: 2rem !important;
        flex: 1;
        min-height: 60vh;
      }

      /* Custom footer using existing design system */
      .admin-footer-section {
        background: rgba(255, 255, 255, 0.02);
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        padding: 2rem;
        margin-top: auto;
      }

      .admin-footer-content {
        max-width: var(--container-max);
        margin: 0 auto;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 2rem;
      }

      .footer-brand {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
      }

      .footer-logo {
        width: 2.5rem;
        height: 2.5rem;
        background: linear-gradient(135deg, var(--color-primary), #d97706);
        border-radius: 0.75rem;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1rem;
      }

      .footer-title {
        font-size: 1.25rem;
        font-weight: bold;
        color: var(--color-content);
        font-family: var(--font-display);
        margin: 0;
      }

      .footer-subtitle {
        font-size: 0.75rem;
        color: var(--color-muted);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin: 0;
      }

      .footer-description {
        color: var(--color-muted);
        line-height: 1.6;
        font-size: 0.875rem;
      }

      .footer-section h4 {
        color: var(--color-content);
        font-weight: 600;
        margin-bottom: 1rem;
        font-family: var(--font-display);
      }

      .footer-links {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .footer-links li {
        margin-bottom: 0.5rem;
      }

      .footer-links a {
        color: var(--color-muted);
        text-decoration: none;
        transition: var(--transition-fast);
        font-size: 0.875rem;
      }

      .footer-links a:hover {
        color: var(--color-primary);
      }

      .footer-contact {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 0.75rem;
        color: var(--color-muted);
        font-size: 0.875rem;
      }

      .footer-contact i {
        color: var(--color-primary);
        width: 1rem;
        text-align: center;
      }

      .footer-bottom {
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        margin-top: 2rem;
        padding-top: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
      }

      .footer-copyright {
        color: var(--color-muted);
        font-size: 0.875rem;
      }

      .footer-actions {
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .footer-btn {
        padding: 0.5rem 1rem;
        background: rgba(255, 255, 255, 0.05);
        color: var(--color-content);
        text-decoration: none;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        transition: var(--transition-fast);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .footer-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-primary);
      }

      /* System status indicators */
      .system-status {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        flex-wrap: wrap;
      }

      .status-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
      }

      .status-item.healthy .status-dot {
        background: #22c55e;
      }

      .status-item.warning .status-dot {
        background: var(--color-primary);
      }

      /* Flash messages using design system */
      .flash-messages {
        margin: 1rem 2rem;
      }

      .flash {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 1rem 1.5rem;
        border-radius: 0.75rem;
        margin-bottom: 0.75rem;
        font-weight: 500;
      }

      .flash.success {
        background: rgba(34, 197, 94, 0.1);
        border: 1px solid rgba(34, 197, 94, 0.3);
        color: #22c55e;
      }

      .flash.error {
        background: rgba(239, 68, 68, 0.1);
        border: 1px solid rgba(239, 68, 68, 0.3);
        color: #ef4444;
      }

      .flash.alert {
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid rgba(245, 158, 11, 0.3);
        color: var(--color-primary);
      }

      /* Responsive design */
      @media (max-width: 768px) {
        .admin-hero-content {
          flex-direction: column;
          text-align: center;
        }

        .admin-hero-title {
          font-size: 2rem;
        }

        .admin-footer-content {
          grid-template-columns: 1fr;
          text-align: center;
        }

        .footer-bottom {
          flex-direction: column;
          text-align: center;
        }

        #active_admin_content {
          padding: 1rem !important;
        }
      }

      /* Animation using existing keyframes */
      @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
      }
    </style>
  </head>

  <body class="active_admin admin-layout" data-admin-target="body">

    <!-- Custom Admin Hero Section -->
    <section class="admin-hero-section">
      <div class="admin-hero-content">
        <div>
          <h1 class="admin-hero-title gradient-text">
            Bonjour <%= current_user&.first_name || 'Admin' %> !
          </h1>
          <p class="admin-hero-subtitle">
            Panel d'administration CinÃ©Room - <%= Date.current.strftime("%d %B %Y") %>
          </p>
          <div class="admin-hero-status">
            <div class="status-dot"></div>
            <span>SystÃ¨me opÃ©rationnel â€¢ DerniÃ¨re mise Ã  jour: <%= Time.current.strftime("%H:%M") %></span>
          </div>
        </div>

        <div class="admin-quick-nav">
          <%= link_to admin_movies_path, class: "admin-nav-btn primary" do %>
            <i class="fas fa-film"></i> Films
          <% end %>
          <%= link_to admin_events_path, class: "admin-nav-btn secondary" do %>
            <i class="fas fa-calendar-alt"></i> Ã‰vÃ©nements
          <% end %>
          <%= link_to admin_users_path, class: "admin-nav-btn secondary" do %>
            <i class="fas fa-users"></i> Utilisateurs
          <% end %>
        </div>
      </div>
    </section>

    <!-- Flash Messages -->
    <% if notice || alert %>
      <div class="flash-messages">
        <% if notice %>
          <div class="flash success">
            <i class="fas fa-check-circle"></i>
            <span><%= notice %></span>
          </div>
        <% end %>
        <% if alert %>
          <div class="flash error">
            <i class="fas fa-exclamation-circle"></i>
            <span><%= alert %></span>
          </div>
        <% end %>
      </div>
    <% end %>

    <!-- Main ActiveAdmin Content -->
    <main>
      <%= yield %>
    </main>

    <!-- Custom Admin Footer -->
    <footer class="admin-footer-section">
      <div class="admin-footer-content">

        <!-- Brand Section -->
        <div>
          <div class="footer-brand">
            <div class="footer-logo">
              <i class="fas fa-film"></i>
            </div>
            <div>
              <h3 class="footer-title">CinÃ©Room</h3>
              <p class="footer-subtitle">Admin Panel</p>
            </div>
          </div>
          <p class="footer-description">
            Interface d'administration pour la gestion complÃ¨te de votre plateforme de cinÃ©ma indÃ©pendant.
          </p>
        </div>

        <!-- Navigation Links -->
        <div>
          <h4>Navigation</h4>
          <ul class="footer-links">
            <li><%= link_to "Dashboard", admin_root_path %></li>
            <li><%= link_to "Films", admin_movies_path %></li>
            <li><%= link_to "Ã‰vÃ©nements", admin_events_path %></li>
            <li><%= link_to "Utilisateurs", admin_users_path %></li>
            <li><%= link_to "Participations", admin_participations_path %></li>
          </ul>
        </div>

        <!-- System Status -->
        <div>
          <h4>Ã‰tat du SystÃ¨me</h4>
          <div class="system-status">
            <div class="status-item healthy">
              <div class="status-dot"></div>
              <span>OpÃ©rationnel</span>
            </div>
            <div class="status-item healthy">
              <div class="status-dot"></div>
              <span>Base de donnÃ©es</span>
            </div>
          </div>

          <div class="footer-contact">
            <i class="fas fa-server"></i>
            <span>Serveur: <%= Rails.env.capitalize %></span>
          </div>

          <div class="footer-contact">
            <i class="fas fa-clock"></i>
            <span>Version: Admin v1.0</span>
          </div>
        </div>
      </div>

      <!-- Footer Bottom -->
      <div class="footer-bottom">
        <div class="footer-copyright">
          Â© 2025 CinÃ©Room. Panel d'administration.
        </div>

        <div class="footer-actions">
          <%= link_to root_path, class: "footer-btn" do %>
            <i class="fas fa-external-link-alt"></i>
            <span>Site Public</span>
          <% end %>

          <%= button_to destroy_user_session_path, method: :delete, class: "footer-btn",
              data: { confirm: "ÃŠtes-vous sÃ»r de vouloir vous dÃ©connecter ?" } do %>
            <i class="fas fa-sign-out-alt"></i>
            <span>DÃ©connexion</span>
          <% end %>
        </div>
      </div>
    </footer>

  </body>
</html>
