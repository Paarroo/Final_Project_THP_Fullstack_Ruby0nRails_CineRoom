<div class="min-h-screen bg-dark-400 py-12 px-4">
  <div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="text-center mb-12">
      <div class="inline-flex items-center space-x-4 mb-6">
        <div class="w-20 h-20 bg-gradient-to-br from-yellow-400 via-orange-500 to-red-600 rounded-2xl flex items-center justify-center shadow-2xl">
          <span class="text-3xl">🎬</span>
        </div>
        <div>
          <h1 class="text-4xl font-bold gradient-text">QR Code d'Entrée</h1>
          <p class="text-gray-400 text-lg">Billet #<%= @participation.id.to_s.rjust(6, '0') %></p>
        </div>
      </div>
    </div>

    <!-- QR Code Section Centrée -->
    <div class="flex justify-center mb-12">
      <div class="glass-effect p-10 rounded-3xl max-w-md w-full text-center">
        <div class="mb-8">
          <h2 class="text-3xl font-bold text-white mb-3 flex items-center justify-center">
            <span class="mr-3">🔍</span>
            Code d'Entrée
          </h2>
          <p class="text-gray-300 text-lg">Présentez ce code à l'entrée de l'événement</p>
        </div>

        <div class="bg-white p-8 rounded-2xl mb-8 mx-auto shadow-xl">
          <div class="w-72 h-72 mx-auto">
            <% if @participation.qr_code_token.present? %>
              <% begin %>
                <%= image_tag(participation_qr_code_path(@participation, format: :png),
                      alt: "QR Code pour l'entrée",
                      class: "w-full h-full object-contain",
                      onerror: "this.src='<%= asset_path('qr_placeholder.svg') %>'") %>
              <% rescue => e %>
                <!-- Fallback si erreur de génération -->
                <div class="w-full h-full bg-gray-100 rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-gray-300">
                  <span class="text-6xl mb-4">🎫</span>
                  <div class="text-center">
                    <p class="text-gray-700 font-semibold">QR Code</p>
                    <p class="text-gray-500 text-sm">Token: <%= @participation.qr_code_token[0..10] %>...</p>
                    <p class="text-gray-500 text-xs mt-2">Présentez ce token à l'entrée</p>
                  </div>
                </div>
              <% end %>
            <% else %>
              <div class="w-full h-full bg-gray-200 rounded-xl flex items-center justify-center">
                <span class="text-gray-500 text-lg">QR Code indisponible</span>
              </div>
            <% end %>
          </div>
        </div>

        <div class="space-y-6">
          <% if @participation.used? %>
            <div class="bg-cinema-red/20 border border-cinema-red/30 rounded-xl p-4">
              <p class="text-cinema-red font-semibold text-lg">✅ Billet déjà utilisé</p>
              <p class="text-red-300 text-sm">
                Entrée validée le <%= I18n.l(@participation.used_at, format: :short) %>
              </p>
            </div>
          <% else %>
            <div class="bg-green-500/20 border border-green-500/30 rounded-xl p-4">
              <p class="text-green-400 font-semibold text-lg">🟢 Billet valide</p>
              <p class="text-green-300">Prêt pour l'entrée</p>
            </div>
          <% end %>

          <!-- Download Options -->
          <div class="flex flex-wrap justify-center gap-4 mt-8">
            <%= link_to participation_qr_code_path(@participation, format: :png),
                class: "glass-effect hover:bg-white/10 text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 font-medium",
                download: "ticket_qr_#{@participation.id}.png" do %>
              <span>📱</span>
              <span>Télécharger PNG</span>
            <% end %>
            
            <%= link_to participation_qr_code_path(@participation, format: :svg),
                class: "glass-effect hover:bg-white/10 text-white px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 font-medium",
                download: "ticket_qr_#{@participation.id}.svg" do %>
              <span>🖼️</span>
              <span>Télécharger SVG</span>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <!-- Event Details Section -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
      <!-- Event Info -->
      <div class="glass-effect p-8 rounded-3xl">
        <h3 class="text-2xl font-bold text-white mb-6 flex items-center justify-center">
          <span class="mr-3">🎭</span>
          Détails de l'événement
        </h3>
        
        <div class="space-y-6 text-gray-300">
          <div class="text-center">
            <p class="font-bold text-white text-2xl mb-2"><%= @participation.event.title %></p>
            <p class="text-gray-400 text-lg">Film : <%= @participation.event.movie.title %></p>
          </div>

          <div class="flex items-center justify-center space-x-4">
            <span class="text-2xl">📅</span>
            <div class="text-center">
              <p class="font-semibold text-white text-lg">
                <%= I18n.l(@participation.event.event_date, format: :long) %>
              </p>
              <p class="text-gray-400">
                <%= @participation.event.start_time.strftime('%H:%M') %>
              </p>
            </div>
          </div>

          <div class="flex items-center justify-center space-x-4">
            <span class="text-2xl">📍</span>
            <div class="text-center">
              <p class="font-semibold text-white text-lg"><%= @participation.event.venue_name %></p>
              <p class="text-gray-400"><%= @participation.event.venue_address %></p>
            </div>
          </div>

          <div class="flex items-center justify-center space-x-4">
            <span class="text-2xl">👤</span>
            <div class="text-center">
              <p class="font-semibold text-white text-lg"><%= @participation.user.full_name %></p>
              <p class="text-gray-400">
                <%= pluralize(@participation.seats, 'place') %>
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical Info -->
      <div class="glass-effect p-8 rounded-3xl">
        <h3 class="text-2xl font-bold text-white mb-6 flex items-center justify-center">
          <span class="mr-3">🔧</span>
          Informations techniques
        </h3>
        
        <div class="space-y-4">
          <div class="flex justify-between items-center border-b border-gray-600 pb-2">
            <span class="text-gray-400 font-medium">Token :</span>
            <span class="text-gray-300 font-mono text-sm">
              <%= @participation.qr_code_token[0..15] %>...
            </span>
          </div>
          
          <div class="flex justify-between items-center border-b border-gray-600 pb-2">
            <span class="text-gray-400 font-medium">Statut :</span>
            <span class="text-white capitalize font-semibold">
              <%= @participation.status %>
            </span>
          </div>
          
          <div class="flex justify-between items-center border-b border-gray-600 pb-2">
            <span class="text-gray-400 font-medium">Généré le :</span>
            <span class="text-gray-300">
              <%= I18n.l(@participation.created_at, format: :short) %>
            </span>
          </div>
          
          <% if @participation.used? %>
            <div class="flex justify-between items-center">
              <span class="text-gray-400 font-medium">Utilisé le :</span>
              <span class="text-green-400 font-semibold">
                <%= I18n.l(@participation.used_at, format: :short) %>
              </span>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Actions Section -->
    <div class="flex flex-wrap justify-center gap-6 mb-12">
      <%= link_to participation_ticket_path(@participation),
          class: "glass-effect hover:bg-white/10 text-white px-8 py-4 rounded-xl transition-all duration-300 flex items-center space-x-3 font-medium text-lg" do %>
        <span class="text-2xl">🎫</span>
        <span>Voir le billet complet</span>
      <% end %>
      
      <%= link_to users_dashboard_path(current_user),
          class: "glass-effect hover:bg-white/10 text-white px-8 py-4 rounded-xl transition-all duration-300 flex items-center space-x-3 font-medium text-lg" do %>
        <span class="text-2xl">👤</span>
        <span>Mon tableau de bord</span>
      <% end %>
    </div>

    <!-- Instructions -->
    <div class="glass-effect p-8 rounded-3xl text-center">
      <h3 class="text-2xl font-bold text-white mb-8 flex items-center justify-center">
        <span class="mr-3">📋</span>
        Instructions d'utilisation
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 text-gray-300">
        <div class="space-y-4">
          <h4 class="font-bold text-white text-xl mb-4 flex items-center justify-center">
            <span class="mr-2">🚪</span>
            À l'arrivée
          </h4>
          <ul class="space-y-2 text-lg">
            <li class="flex items-center justify-center space-x-2">
              <span>⏰</span>
              <span>Arrivez 15 minutes avant l'heure</span>
            </li>
            <li class="flex items-center justify-center space-x-2">
              <span>📱</span>
              <span>Présentez ce QR code à l'entrée</span>
            </li>
            <li class="flex items-center justify-center space-x-2">
              <span>🆔</span>
              <span>Ayez votre pièce d'identité si demandée</span>
            </li>
          </ul>
        </div>
        
        <div class="space-y-4">
          <h4 class="font-bold text-white text-xl mb-4 flex items-center justify-center">
            <span class="mr-2">🎬</span>
            Pendant l'événement
          </h4>
          <ul class="space-y-2 text-lg">
            <li class="flex items-center justify-center space-x-2">
              <span>🎫</span>
              <span>Gardez votre billet jusqu'à la fin</span>
            </li>
            <li class="flex items-center justify-center space-x-2">
              <span>🚫</span>
              <span>Ce billet est personnel et non transférable</span>
            </li>
            <li class="flex items-center justify-center space-x-2">
              <span>⚠️</span>
              <span>Respectez les consignes de sécurité</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>