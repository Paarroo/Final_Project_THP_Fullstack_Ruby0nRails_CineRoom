<!-- Admin Sidebar with Stimulus Controller -->
<aside
  class="admin-sidebar fixed left-0 top-0 h-full w-64 glass-effect border-r border-white/10 z-40 transform transition-transform duration-300"
  data-controller="admin-sidebar"
  data-admin-sidebar-target="sidebar"
  data-admin-target="sidebar"
>
  <!-- Sidebar Header -->
  <div class="sidebar-header p-6 border-b border-white/10">
    <%= link_to admin_root_path,
        class: "flex items-center space-x-3 group",
        data: { turbo: false } do %>
      <div class="w-12 h-12 bg-gradient-to-br from-primary to-primary/80 rounded-xl flex items-center justify-center group-hover:scale-105 transition-transform duration-300">
        <i class="fas fa-film text-white text-xl"></i>
      </div>
      <div class="flex flex-col">
        <span class="text-xl font-bold tracking-tight text-content font-display">CinéRoom</span>
        <span class="text-xs text-muted uppercase tracking-widest">Admin Panel</span>
      </div>
    <% end %>
  </div>

  <!-- Navigation Menu -->
  <nav class="sidebar-nav p-6" data-admin-sidebar-target="nav">
    <div class="space-y-2">
      <!-- Dashboard -->
      <%= render 'shared/admin/nav_item',
          path: admin_root_path,
          icon: 'fas fa-tachometer-alt',
          label: 'Dashboard',
          active: current_page?(admin_root_path) %>

      <!-- Séparateur -->
      <div class="nav-divider my-4 h-px bg-white/10"></div>

      <!-- Content Management -->
      <div class="nav-section" data-admin-sidebar-target="section">
        <h3 class="nav-section-title text-xs font-semibold text-muted uppercase tracking-wider mb-3">
          Gestion Contenu
        </h3>

        <%= render 'shared/admin/nav_item',
            path: admin_movies_path,
            icon: 'fas fa-film',
            label: 'Films',
            badge: Movie.where(validation_status: :pending).count,
            active: current_page?(admin_movies_path) %>

        <%= render 'shared/admin/nav_item',
            path: admin_events_path,
            icon: 'fas fa-calendar-alt',
            label: 'Événements',
            badge: Event.where(status: :upcoming).count,
            active: current_page?(admin_events_path) %>

        <%= render 'shared/admin/nav_item',
            path: admin_participations_path,
            icon: 'fas fa-users',
            label: 'Participations',
            badge: Participation.where(status: :pending).count,
            active: current_page?(admin_participations_path) %>

        <%= render 'shared/admin/nav_item',
            path: admin_reviews_path,
            icon: 'fas fa-star',
            label: 'Avis',
            active: current_page?(admin_reviews_path) %>
      </div>

      <!-- Séparator -->
      <div class="nav-divider my-4 h-px bg-white/10"></div>

      <!-- User Management -->
      <div class="nav-section" data-admin-sidebar-target="section">
        <h3 class="nav-section-title text-xs font-semibold text-muted uppercase tracking-wider mb-3">
          Utilisateurs
        </h3>

        <%= render 'shared/admin/nav_item',
            path: admin_users_path,
            icon: 'fas fa-users',
            label: 'Utilisateurs',
            badge: User.where(created_at: 1.week.ago..Time.current).count,
            active: current_page?(admin_users_path) %>
      </div>

      <!-- Séparator -->
      <div class="nav-divider my-4 h-px bg-white/10"></div>

      <!-- Quick Actions -->
      <div class="nav-section" data-admin-sidebar-target="section">
        <h3 class="nav-section-title text-xs font-semibold text-muted uppercase tracking-wider mb-3">
          Actions Rapides
        </h3>

        <button
          class="nav-quick-action w-full text-left px-3 py-2 rounded-xl text-sm text-muted hover:text-content hover:bg-white/5 transition-colors duration-200"
          data-action="click->admin-sidebar#exportData"
          data-admin-sidebar-target="quickAction"
        >
          <i class="fas fa-download mr-3 w-4"></i>
          Exporter données
        </button>

        <button
          class="nav-quick-action w-full text-left px-3 py-2 rounded-xl text-sm text-muted hover:text-content hover:bg-white/5 transition-colors duration-200"
          data-action="click->admin-sidebar#backupDatabase"
          data-admin-sidebar-target="quickAction"
        >
          <i class="fas fa-database mr-3 w-4"></i>
          Sauvegarde BDD
        </button>
      </div>
    </div>
  </nav>

  <!-- Sidebar Footer -->
  <div class="sidebar-footer absolute bottom-0 left-0 right-0 p-6 border-t border-white/10">
    <div class="flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
          <span class="text-xs font-bold text-white">
            <%= current_user&.first_name&.first&.upcase || 'A' %>
          </span>
        </div>
        <div class="flex flex-col">
          <span class="text-sm font-medium text-content">
            <%= current_user&.full_name || 'Admin' %>
          </span>
          <span class="text-xs text-muted">Administrateur</span>
        </div>
      </div>

      <%= button_to admin_logout_path, method: :delete,
          class: "w-8 h-8 glass-effect rounded-lg flex items-center justify-center text-muted hover:text-content hover:bg-white/10 transition-colors duration-200",
          data: {
            confirm: "Êtes-vous sûr de vouloir vous déconnecter ?",
            admin_sidebar_target: "logoutBtn"
          } do %>
        <i class="fas fa-sign-out-alt text-sm"></i>
      <% end %>
    </div>
  </div>
</aside>

<!-- Mobile Sidebar Overlay -->
<div
  class="sidebar-overlay fixed inset-0 bg-black/50 z-30 lg:hidden hidden"
  data-admin-sidebar-target="overlay"
  data-action="click->admin-sidebar#closeSidebar"
></div>
