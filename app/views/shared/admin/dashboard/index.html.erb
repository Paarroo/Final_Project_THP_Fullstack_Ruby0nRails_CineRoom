<%#
  Custom Admin Dashboard integrated with ActiveAdmin layout
  Modern design with glass effects and responsive metrics
%>

<div
  class="custom-admin-dashboard"
  data-controller="admin-dashboard"
  data-admin-dashboard-refresh-interval-value="30000"
  data-admin-dashboard-auto-refresh-value="true"
>
  <!-- Dashboard Header -->
  <div class="dashboard-header">
    <div class="page_title_wrapper">
      <h1 class="page_title">Dashboard CinéRoom</h1>
      <div class="dashboard-actions" style="float: right; margin-top: -40px;">
        <button
          class="button"
          data-action="click->admin-dashboard#refreshDashboard"
          data-admin-dashboard-target="refreshButton"
        >
          <i class="fas fa-sync-alt"></i> Actualiser
        </button>
      </div>
    </div>
  </div>

  <!-- Key Metrics -->
  <div class="dashboard-metrics" style="margin: 20px 0;">
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">

      <!-- Revenue Metric -->
      <div class="metric-card panel">
        <h3>Revenus Total</h3>
        <div class="metric-value" style="font-size: 2em; color: #f59e0b; font-weight: bold;">
          <%= number_to_currency(@revenue_stats[:total_revenue]) %>
        </div>
        <div class="metric-trend" style="color: #22c55e;">
          <i class="fas fa-arrow-up"></i> +12.5%
        </div>
      </div>

      <!-- Events Metric -->
      <div class="metric-card panel">
        <h3>Événements Actifs</h3>
        <div class="metric-value" style="font-size: 2em; color: #2563eb; font-weight: bold;">
          <%= @event_stats[:upcoming_events] %>
        </div>
        <div class="metric-trend" style="color: #22c55e;">
          <i class="fas fa-arrow-up"></i> +<%= @event_stats[:upcoming_events] - @event_stats[:completed_events] %>
        </div>
      </div>

      <!-- Users Metric -->
      <div class="metric-card panel">
        <h3>Utilisateurs Total</h3>
        <div class="metric-value" style="font-size: 2em; color: #22c55e; font-weight: bold;">
          <%= @user_stats[:total_users] %>
        </div>
        <div class="metric-trend" style="color: #22c55e;">
          <i class="fas fa-arrow-up"></i> +<%= @user_stats[:new_users_this_month] %>
        </div>
      </div>

      <!-- Satisfaction Metric -->
      <div class="metric-card panel">
        <h3>Satisfaction</h3>
        <div class="metric-value" style="font-size: 2em; color: #f59e0b; font-weight: bold;">
          <%= (Review.average(:rating) || 0).round(1) %>/5
        </div>
        <div class="metric-trend" style="color: #22c55e;">
          <i class="fas fa-star"></i> +0.2
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0;">
    <!-- Revenue Chart -->
    <div class="panel">
      <h3>Évolution des Revenus</h3>
      <div
        class="chart-container"
        data-controller="admin-chart"
        data-admin-chart-type-value="line"
        data-admin-chart-data-value="<%= revenue_chart_data.to_json %>"
        style="height: 300px;"
      >
        <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
          <div style="text-align: center;">
            <i class="fas fa-chart-line" style="font-size: 3em; margin-bottom: 10px;"></i>
            <p>Graphique des revenus</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Events Chart -->
    <div class="panel">
      <h3>Statut des Événements</h3>
      <div
        class="chart-container"
        data-controller="admin-chart"
        data-admin-chart-type-value="doughnut"
        data-admin-chart-data-value="<%= events_status_chart_data.to_json %>"
        style="height: 300px;"
      >
        <div style="display: flex; align-items: center; justify-content: center; height: 100%; color: #666;">
          <div style="text-align: center;">
            <i class="fas fa-chart-pie" style="font-size: 3em; margin-bottom: 10px;"></i>
            <p>Répartition des événements</p>
          </div>
        </div>
      </div>
    </div>
  </div>
